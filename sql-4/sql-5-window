Для Postgres оконные функции:
row_number() — номер текущей строки в её разделе, начиная с 1;
rank() — ранг текущей строки с пропусками; то же, что и row_number для первой родственной ей строки;
dense_rank() — ранг текущей строки без пропусков; эта функция считает группы родственных строк;
percent_rank() — относительный ранг текущей строки, вычисляется по формуле: percent_ rank = (rank - 1) / (Nстрок - 1);
cume_dist() — относительный ранг текущей строки: (число строк, предшествующих или родственных текущей) / (общее число строк);
ntile(число_групп) — ранжирование по целым числам от 1 до значения аргумента так, чтобы размеры групп были максимально близки;
lag(значение [, смещение [,значение_по_умолчанию]]) — значение для строки, положение которой задаётся смещением от текущей строки к началу раздела;
lead(значение [, смещение [,значение_по_умолчанию]]) — значение для строки, положение которой задаётся смещением от текущей строки к концу раздела;
first_value() — значение, вычисленное для первой строки в рамке окна;
last_value() — значение, вычисленное для последней строки в рамке окна;
nth_value() — значение, вычисленное для n-oй строки в рамке окна.
